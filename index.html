<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ø³Ø± Ø§Ù„Ø¥Ù„Ù‡ÙŠ - Ø¨Ù†Øª Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„Ø­Ø³ÙŠÙ† Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù… Ø±Ù‚ÙŠÙ‘Ù‡</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link rel="manifest" href="manifest.json">
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Arial', sans-serif; direction:rtl; background:#f9f9f9; color:#333; padding-bottom:60px; }
h1 { text-align:center; margin:20px 0; font-size:24px; }

/* Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
.media-player { position:relative; width:90%; max-width:720px; margin:20px auto; background:#000; border-radius:10px; overflow:hidden; }
video { width:100%; display:block; border-radius:10px; }
.controls-overlay { position:absolute; bottom:0; left:0; width:100%; background:rgba(0,0,0,0.5); display:flex; flex-direction:column; padding:5px; box-sizing:border-box; }
.progress-bar { width:100%; height:5px; background:#555; cursor:pointer; margin-bottom:5px; border-radius:3px; position:relative; }
.progress-filled { height:100%; background:#00bcd4; width:0%; border-radius:3px; }
.controls-buttons { display:flex; justify-content:center; align-items:center; gap:10px; flex-wrap:wrap; }
.controls-buttons button { background:none; border:none; color:#fff; font-size:20px; cursor:pointer; display:flex; align-items:center; gap:5px; }
.controls-buttons button:hover { color:#00bcd4; }

/* Ø§Ù„Ù†Ø¨Ø°Ø© Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠØ© */
.about-section { background:#fff; padding:15px; margin:20px auto; border-radius:8px; width:90%; box-shadow:0 2px 5px rgba(0,0,0,0.2); text-align:justify; }

/* Ø²Ø± Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© */
.details-button { display:block; width:90%; margin:10px auto; text-align:center; }
.details-button button { background:#00bcd4; color:white; border:none; padding:10px; border-radius:5px; cursor:pointer; width:100%; font-size:16px; }
.details-button button:hover { background:#0097a7; }
.secondary-buttons { display:none; flex-direction:column; margin-top:10px; }
.secondary-buttons a { display:block; padding:8px; margin:5px 0; background:#f0f0f0; border-radius:5px; text-decoration:none; color:#333; text-align:center; }
.secondary-buttons a:hover { background:#e0e0e0; }

/* Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª */
#posts { display:none; width:90%; max-width:900px; margin:20px auto; }
#posts input, #posts textarea { width:100%; padding:10px; border-radius:5px; border:1px solid #ccc; margin-bottom:10px; }
#posts button { background:#00bcd4; color:#fff; border:none; padding:10px; border-radius:5px; cursor:pointer; width:100%; margin-bottom:10px; font-size:16px; }
#posts button:hover { background:#0097a7; }
.posts-container { display:flex; gap:10px; flex-wrap:wrap; }
.posts-section { flex:1; background:#fff; padding:10px; border-radius:5px; box-shadow:0 1px 3px rgba(0,0,0,0.2); }
.posts-section h3 { margin-bottom:10px; }
.post { background:#f0f0f0; padding:8px; border-radius:5px; margin-bottom:8px; }
.post-header { display:flex; justify-content:space-between; margin-bottom:5px; font-weight:bold; }
.nickname { color:#00bcd4; }
.username { color:#555; font-size:12px; }
.post-interactions button { margin-right:5px; cursor:pointer; }

/* Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø³ÙÙ„ÙŠ */
.bottom-bar { position:fixed; bottom:0; width:100%; background:#333; display:flex; justify-content:space-around; padding:10px 0; box-shadow:0 -2px 5px rgba(0,0,0,0.2); }
.bottom-bar a { color:white; text-decoration:none; font-size:14px; display:flex; flex-direction:column; align-items:center; }
.bottom-bar a i { font-size:20px; margin-bottom:5px; }
.bottom-bar a:hover { color:#00bcd4; }

/* Ø²Ø± ØªØ«Ø¨ÙŠØª PWA */
#installApp { display:flex; justify-content:center; margin-top:20px; }
#installApp button { background:#00bcd4; color:white; padding:10px 20px; border-radius:5px; cursor:pointer; font-size:16px; }
#installApp button:hover { background:#0097a7; }

/* Ø¥Ø¸Ù‡Ø§Ø± ØµÙØ­Ø© Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª */
.page { display:none; }
.page.active { display:block; }

</style>
</head>
<body>

<h1>Ø§Ù„Ø³Ø± Ø§Ù„Ø¥Ù„Ù‡ÙŠ - Ø¨Ù†Øª Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„Ø­Ø³ÙŠÙ† Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù… Ø±Ù‚ÙŠÙ‘Ù‡</h1>

<!-- Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ -->
<div class="media-player page active" id="home">
    <video id="videoPlayer" playsinline></video>
    <div class="controls-overlay">
        <div class="progress-bar" id="progressBar">
            <div class="progress-filled" id="progressFilled"></div>
        </div>
        <div class="controls-buttons">
            <button id="prevBtn"><i class="fas fa-backward"></i></button>
            <button id="playPauseBtn"><i class="fas fa-play"></i></button>
            <button id="nextBtn"><i class="fas fa-forward"></i></button>
            <button id="repeatBtn"><i class="fas fa-retweet"></i></button>
            <button id="downloadBtn"><i class="fas fa-download"></i></button>
            <button id="fullscreenBtn"><i class="fas fa-expand"></i></button>
        </div>
    </div>
</div>

<!-- Ø§Ù„Ù†Ø¨Ø°Ø© Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠØ© -->
<div class="about-section page active">
    <p>
        Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠÙ‚Ø¯Ù… Ù†Ø¨Ø°Ø© Ø­ÙˆÙ„ Ù…Ø¹Ø¬Ø²Ø© Ø§Ù„Ø±Ø¬Ø¹Ø© ÙˆØ£Ø­Ø¯Ø§Ø«Ù‡Ø§ ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ù…Ù„ÙƒÙˆØª ÙˆØ¹Ø§Ù„Ù… Ø§Ù„Ø¯Ù†ÙŠØ§ØŒ Ø¨Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ù…Ù†Ø§Ù‚Ø´Ø© Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„Ù†Ø³Ø® ÙˆØ§Ù„ØªÙ‚Ù…Øµ ÙˆØ£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù…Ø¹Ø¬Ø²Ø©.
    </p>
</div>

<!-- Ø²Ø± ØªÙØ§ØµÙŠÙ„ Ù…Ø¹Ø¬Ø²Ø© Ø§Ù„Ø±Ø¬Ø¹Ø© -->
<div class="details-button page active">
    <button id="toggleButton">ØªÙØ§ØµÙŠÙ„ Ù…Ø¹Ø¬Ø²Ø© Ø§Ù„Ø±Ø¬Ø¹Ø©</button>
    <div id="secondaryButtons" class="secondary-buttons">
        <a href="#">Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©</a>
        <a href="#">Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø±Ø¬Ø¹Ø© ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ù…Ù„ÙƒÙˆØª</a>
        <a href="#">Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø±Ø¬Ø¹Ø© ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ø¯Ù†ÙŠØ§</a>
        <a href="#">Ù…Ø§Ù‡ÙŠ Ø§Ù„Ù…Ø¹Ø¬Ø²Ø©</a>
        <a href="#">Ø¥Ø´ÙƒØ§Ù„ÙŠØ§Øª Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ù†Ø³Ø® ÙˆØ§Ù„ØªÙ‚Ù…Øµ</a>
        <a href="#">Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù…Ø¹Ø¬Ø²Ø©</a>
        <a href="#">Ù‡Ù„ ØªØªØ¹Ø§Ø±Ø¶ Ù…Ø¹ Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„ØªÙƒÙˆÙŠÙ†ÙŠØ©ØŸ</a>
        <a href="#">Ù‡Ù„ ØªØªØ¹Ø§Ø±Ø¶ Ù…Ø¹ Ø±Ø¬Ø¹Ø© Ø§Ù„Ø£Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹ØµÙˆÙ…ÙŠÙ†ØŸ</a>
        <a href="#">ÙƒØ±Ø§Ù…Ø§ØªÙ‡Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø±Ø¬Ø¹Ø©</a>
        <a href="#">Ø¢ÙŠØ§Øª Ùˆ Ø¨Ø±Ø§Ù‡ÙŠÙ†</a>
        <a href="#">Ø¥Ø³Ù„ÙˆØ¨ Ø­ÙŠØ§ØªÙ‡Ø§ Ùˆ ØªØ¹Ø§ÙŠØ´Ù‡Ø§ ÙÙŠ Ø²Ù…Ø§Ù†Ù†Ø§</a>
        <a href="#">Ø­ÙˆØ§Ø±Ø§Øª ÙˆÙ†Ù‚Ø§Ø´Ø§Øª</a>
    </div>
</div>

<!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª -->
<div id="posts" class="page">
    <input type="text" id="nickname" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±">
    <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ)">
    <button onclick="saveAccount()">Ø­ÙØ¸ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
    <textarea id="newPostText" rows="3" placeholder="Ø§ÙƒØªØ¨ Ù…Ù†Ø´ÙˆØ±Ùƒ Ù‡Ù†Ø§..."></textarea>
    <button onclick="addPost()">Ù†Ø´Ø± Ø§Ù„Ù…Ù†Ø´ÙˆØ±</button>
    <div class="posts-container">
        <div class="posts-section">
            <h3>Ù…Ù†Ø´ÙˆØ±Ø§ØªÙŠ</h3>
            <div id="myPostsList"></div>
        </div>
        <div class="posts-section">
            <h3>Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ø²ÙˆØ§Ø±</h3>
            <div id="visitorPostsList"></div>
        </div>
    </div>
</div>

<!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø³ÙÙ„ÙŠ -->
<div class="bottom-bar">
    <a href="#" onclick="showPage('home')"><i class="fas fa-home"></i>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    <a href="#" onclick="showPage('home')"><i class="fas fa-list"></i>Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹</a>
    <a href="#" onclick="showPage('posts')"><i class="fas fa-newspaper"></i>Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª</a>
    <a href="#" onclick="showPage('home')"><i class="fas fa-comments"></i>Ø§Ù„ØªÙˆØ§ØµÙ„</a>
</div>

<!-- Ø²Ø± ØªØ«Ø¨ÙŠØª ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨ -->
<div id="installApp"></div>

<script>
// ===== Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ =====
const videoList = ["video.mp4","video2.mp4","video3.mp4"];
let currentIndex = 0;
let repeatActive = false;

const videoPlayer = document.getElementById('videoPlayer');
const playPauseBtn = document.getElementById('playPauseBtn');
const nextBtn = document.getElementById('nextBtn');
const prevBtn = document.getElementById('prevBtn');
const repeatBtn = document.getElementById('repeatBtn');
const downloadBtn = document.getElementById('downloadBtn');
const fullscreenBtn = document.getElementById('fullscreenBtn');
const progressBar = document.getElementById('progressBar');
const progressFilled = document.getElementById('progressFilled');

function loadVideo(index){
    videoPlayer.src = videoList[index];
    videoPlayer.load();
    updatePlayPauseIcon();
}

playPauseBtn.addEventListener('click', ()=>{
    if(videoPlayer.paused) videoPlayer.play();
    else videoPlayer.pause();
    updatePlayPauseIcon();
});
function updatePlayPauseIcon(){
    playPauseBtn.innerHTML = videoPlayer.paused ? '<i class="fas fa-play"></i>' : '<i class="fas fa-pause"></i>';
}
nextBtn.addEventListener('click', ()=>{
    currentIndex = (currentIndex + 1) % videoList.length;
    loadVideo(currentIndex);
    videoPlayer.play();
});
prevBtn.addEventListener('click', ()=>{
    currentIndex = (currentIndex - 1 + videoList.length) % videoList.length;
    loadVideo(currentIndex);
    videoPlayer.play();
});
repeatBtn.addEventListener('click', ()=>{
    repeatActive = !repeatActive;
    repeatBtn.style.color = repeatActive ? '#00bcd4' : '#fff';
});
videoPlayer.addEventListener('ended', ()=>{
    if(repeatActive){
        videoPlayer.currentTime = 0;
        videoPlayer.play();
    } else {
        videoPlayer.pause();
        updatePlayPauseIcon();
    }
});
downloadBtn.addEventListener('click', ()=>{
    const link = document.createElement('a');
    link.href = videoList[currentIndex];
    link.download = videoList[currentIndex];
    link.click();
});
videoPlayer.addEventListener('timeupdate', ()=>{
    const percent = (videoPlayer.currentTime / videoPlayer.duration) * 100;
    progressFilled.style.width = percent + '%';
});
progressBar.addEventListener('click', (e)=>{
    const rect = progressBar.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const width = rect.width;
    const newTime = (clickX / width) * videoPlayer.duration;
    videoPlayer.currentTime = newTime;
});
fullscreenBtn.addEventListener('click', ()=>{
    if (!document.fullscreenElement){
        videoPlayer.requestFullscreen();
    } else {
        document.exitFullscreen();
    }
});

// ===== Ø²Ø± Ø§Ù„ØªÙØ§ØµÙŠÙ„ =====
const toggleButton = document.getElementById('toggleButton');
const secondaryButtons = document.getElementById('secondaryButtons');
toggleButton.addEventListener('click', ()=>{
    secondaryButtons.style.display = (secondaryButtons.style.display==="flex")?"none":"flex";
});

// ===== ØªØ«Ø¨ÙŠØª PWA =====
let deferredPrompt;
const installAppDiv = document.getElementById('installApp');
window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installAppDiv.innerHTML = '<button onclick="installApp()">ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>';
});
function installApp(){
    if(deferredPrompt){
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then(choiceResult=>{
            deferredPrompt=null;
        });
    }
}

// ==== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙØ­Ø§Øª ====
function showPage(pageId){
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    const page = document.getElementById(pageId);
    page.classList.add('active');

    if(pageId === 'posts') loadPosts(); // Ù‡Ø°Ø§ ÙŠØ¶Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù‚Ø³Ù…
}

// ==== Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª ÙˆØ­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ====
window.addEventListener('load', ()=>{
    loadVideo(currentIndex);
    loadAccount();
    loadPosts();
});

function saveAccount(){
    let nickname = document.getElementById('nickname').value.trim();
    let username = document.getElementById('username').value.trim();
    const nicknameLength = nickname.replace(/\s/g,'').length;
    if(nicknameLength < 2 || nicknameLength > 110){
        alert("Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø± ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 2 Ùˆ110 Ø­Ø±Ù (Ø¨Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø§Ù„ÙØ±Ø§ØºØ§Øª).");
        return;
    }
    if(!/^[A-Za-z0-9\-._@+\/*=]+$/.test(username)){
        alert("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø±Ù…ÙˆØ² ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§.");
        return;
    }
    const accounts = JSON.parse(localStorage.getItem("accounts")) || {};
    if(accounts[username] && accounts[username] !== nickname){
        alert("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ø¢Ø®Ø±.");
        return;
    }
    accounts[username] = nickname;
    localStorage.setItem("accounts", JSON.stringify(accounts));
    localStorage.setItem("currentUser", JSON.stringify({username, nickname}));
    alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­!");
}

function loadAccount(){
    const currentUser = JSON.parse(localStorage.getItem("currentUser"));
    if(currentUser){
        document.getElementById('nickname').value = currentUser.nickname;
        document.getElementById('username').value = currentUser.username;
    }
}

function addPost(){
    const textarea = document.getElementById('newPostText');
    const text = textarea.value.trim();
    if(text === "") return;
    const currentUser = JSON.parse(localStorage.getItem("currentUser"));
    if(!currentUser){
        alert("ÙŠØ±Ø¬Ù‰ Ø­ÙØ¸ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø£ÙˆÙ„Ø§Ù‹.");
        return;
    }
    const posts = JSON.parse(localStorage.getItem("posts")) || [];
    posts.push({text, username: currentUser.username, nickname: currentUser.nickname, timestamp: Date.now()});
    localStorage.setItem("posts", JSON.stringify(posts));
    textarea.value = "";
    loadPosts();
}

function loadPosts(){
    const posts = JSON.parse(localStorage.getItem("posts")) || [];
    const now = Date.now();
    const oneWeek = 7*24*60*60*1000;
    const recentPosts = posts.filter(p => now - p.timestamp <= oneWeek);
    localStorage.setItem("posts", JSON.stringify(recentPosts));
    const myPostsList = document.getElementById('myPostsList');
    const visitorPostsList = document.getElementById('visitorPostsList');
    myPostsList.innerHTML = "";
    visitorPostsList.innerHTML = "";
    const currentUser = JSON.parse(localStorage.getItem("currentUser"));
    recentPosts.forEach(p=>{
        const postDiv = document.createElement('div');
        postDiv.className = "post";
        postDiv.innerHTML = `<div class="post-header">
            <span class="nickname">${p.nickname}</span>
            <span class="username">@${p.username}</span>
        </div>
        <p>${p.text}</p>
        <div class="post-interactions">
            <button onclick="likePost(this)">ğŸ‘ Ø¥Ø¹Ø¬Ø§Ø¨</button>
            <button onclick="commentPost(this)">ğŸ’¬ ØªØ¹Ù„ÙŠÙ‚</button>
        </div>`;
        if(currentUser && p.username === currentUser.username){
            myPostsList.prepend(postDiv);
        } else {
            visitorPostsList.prepend(postDiv);
        }
    });
}

function likePost(btn){
    btn.innerText = btn.innerText.includes("âœ”ï¸") ? "ğŸ‘ Ø¥Ø¹Ø¬Ø§Ø¨" : "âœ”ï¸ ØªÙ… Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨";
}
function commentPost(btn){
    const comment = prompt("Ø£Ø¯Ø®Ù„ ØªØ¹Ù„ÙŠÙ‚Ùƒ:");
    if(!comment) return;
    const commentEl = document.createElement("p");
    commentEl.style.marginRight = "15px";
    commentEl.innerText = "ğŸ’¬ " + comment;
    btn.parentElement.appendChild(commentEl);
}
</script>

</body>
</html>
